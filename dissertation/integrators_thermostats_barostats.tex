\subsection{Thermostat}

Thermostats are ofter used in molecular dynamics simulation to control the temperature. MD simulations are used to understand, observe and predict the properties of interest for a given system. If we want to compare to results done in laboratory conditions (where temperature is usually constant) we have to sample the canonical ensemble. Therefore the temperature of the system must be maintained at a certain level, and a thermostat should be used.

To determine the temperature of a molecular dynamics simulation we can use the equipartition theorem involving the kinetic energy of the system

\begin{equation}
  \frac{3}{2} N k_b T = \langle \sum_{i=1}^{N} \frac{1}{2} m_i v_{i}^2 \rangle
\end{equation}

The temperature is a time averaged quantity indicated by the brackets, meaning that it is an average over many snapshots of the simulation. Applying the equipartition theorem to just a single snapshot of the simulation, we get the instantaneous temperature. The instantaneous temperature is usually not equal to the desired ensemble temperature, but it should fluctuate around that value, the target temperature.

In general, thermostat work by altering the Newtonian equations of motion, which inherently conserve the energy. Therefore one should not use a thermostat if the desired property is dynamical (for example the diffusion coefficient); but instead, the thermostat is used to bring the system to the desired temperature then turned off. While thermostats give non-physical dynamics, some have less effect on particular dynamical properties and are save to use in molecular dynamics simulations.

There are two ways to categories thermostats: (i) they can be either deterministic or stochastic depending on whether they use random numbers to alter the equations of motion or (ii) global or local based on the extent of the effect, whether its on the full system or just a subset of the particles. Thermostats also differ in the algorithm used to control the temperature. Certain thermostats operate by rescaling the velocities of the particles outside the dynamics, by applying the change after a simulation timestep has happened and the coordinates and velocities have been updated. Others include implicit or explicit collisions with an external heat bath.

\subsection{Barostat}

Thermodynamic properties of interest are measure inside laboratory condition, therefore, at short timescale the system is under constant temperature \emph{and} pressure. The pressure is usually at atmospheric pressure, unless some form of pressure control is used, for example a piston, inert gas, etc. This set of conditions is part of the isothermal-isobaric ensemble, probably the most common ensemble in molecular dynamics simulation, especially that of biologically relevant systems. Similar to thermostat, if the pressure in the system needs to be constant, a barostat algorithm should be used.

Barostats control the pressure if the system, so if the aforementioned isothermal-isobaric ensemble is desires, that they must be used in conjunction with a thermostat. Without one, we would be in a isoenthalpic-isobaric ensemble, where only the number of particles, the pressure and the enthalpy  of the system is constant.

The background if barostat is analogous to that of thermostats. The virial theorem is used to measure the pressure in a molecular dynamics simulation. In the case of periodic boundary conditions and pairwise interactions, other equations are considered. Nonetheless, these formulas also provide pressure as a time averaged quantity over the simulation range. The pressure calculated just from a single snapshot is termed the instantaneous pressure. Similarly to temperature, the instantaneous pressure is not equal to the target, but fluctuates constantly around that value during the simulation.

To model the idea of a barostat, consider a system that is compressed/expanded by a hypothetical piston from every direction with a uniform force. Since it is acting from all directions it can be considered that the compression is uniform. The mass of the piston can be changes to correspond to stronger compression force. This changes the frequency with which particles interact with the system enclosure. These impacts on the simulation box can be related to the stress the surrounding is applying to the system.

\subsection{Integrators}

Any system with more than three interacting bodies has a solution to their equation motion that cannot be analytically derived. Instead, approximation have to be introduced to the dynamics of a system by numerical methods in a discrete manner, termed numerical integration of the equations of motion. The algorithms that perform such numerical integration are called integrators. A key criteria for any integrator is energy conservation at short and long timescales.

There are certain feature that integrators should have in order to be effectively used in molecular dynamics simulations. To start with, the integrator should introduce little error in the dynamics of the system. By definition integrators use discretisation to approximate the dynamics of the continuous motion, therefore they will introduce an error because of this approximation. Alongside discretisation errors, an additional source of error comes from truncating the numbers as they are stored in computers to a fixed precision. There are many strategies to reduce discretisation error, while truncation error can be reduced by increasing the precision of the floating point numbers used by the computer code.

By minimising the discretisation error, we want to minimise errors in the phase space volume and conserve the energy during simulation. If phase space volume changes over the simulation, then the system is, by definition, is a different ensemble from one timestep to the next. This means that the data collected during simulation is from different ensembles. One simple solution is to guarantee that the integrator is reversible. If the operator that propagates the system preserves phase space, then by definition is also reversible, in other words the operator is applied to a state stepping $\delta t$ forward, and then applying the same operator $-\delta t$ step, and the system remains the same, than we have reversibility and hence phase space volume conservation. 