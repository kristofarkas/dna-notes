\documentclass{report}

\usepackage{booktabs}
\usepackage{siunitx}
\DeclareSIUnit{\calorie}{cal}

\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfplotsset{compat=newest}

\usepackage{physics}

\usepackage{amsmath}
\usepackage{tikz}
\usetikzlibrary{positioning, calc}

\pgfmathsetmacro{\s}{0.5}
\pgfmathsetmacro{\r}{0.5cm}

\usepackage[caption=false]{subfig}


\title{Predicting the mutagenecity of DNA intercalators through binding affinity calculations}
\author{Kristof Farkas-Pall}

\setcounter{tocdepth}{3}

\begin{document}

\maketitle

\tableofcontents

\chapter{Introduction}

\input{introduction}

\subsection{Structure}

\subsection{Mutations}

\section{DNA modelling and Molecular dynamics}

\subsection{Atomistic modelling}

The structure of biomolecule, like DNA is complex and interesting. How can we gain insight into the atomic composition of structures like this on an atomic level? Experimental techniques, like cryo-em, x-ray crystallography or NMR provide information about the composition at a resolution small enough to distinguish atoms, and some methods also provide dynamical properties too. However, certain phenomena or physical property is simply out of the reach of these experimental techniques. In silico techniques, such as molecular dynamics, can provide insight otherwise not accessible to experimentalists. The focus of this thesis is applying such in silico methods to bio-molecular systems, with a particular emphasis on molecular dynamics. 

Nonetheless, as a starting model, even in silico methods take data from experiment, therefore it is briefly described here.

\input{experimental_models}

\subsection{Computational modelling}

Simulating a system via computational methods requires an initial model, where by model, we refer to the coordinates of every particle in the structure of interest. If, for example, we want to simulation nucleic acid structures, then the model is the three dimensional coordinate of every atom in the DNA structure. In general the model can be build in one of two ways: by hand de novo, or using another source (experimentally derived structures for example). The quality of the inital starting structure can have a large effect on the computational results and the validity of the simulation. This will become apparent in the results section, where two similar systems were simulated with different levels of initial structure validity.   

\subsubsection{QM}

In a quantum mechanical description of a system, the electrons are explicitly accounted for as they are the fundamental particles of this level of description. The energy of the system is calculated as the interaction energy between electrons based on electronic structure calculations. There are few (if any) empirical or fitted parameters in these models, but the underlying physical description is sometimes approximated for tractability. Usually QM calculations are very expensive and scale cubic (or worse) with the number of electrons in the system.

\subsubsection{MM}

In molecular mechanics the description is based on particles corresponding to atoms. Every atom in the system has a number of parameters defining the interaction between other particles, including a partial charge, bond, angle and torsion parameters, and non-bonded interaction parameters. These parameters are all empirically determined (fitted to experimental observables, quantum mechanical calculations, or other data). MM simulations are faster than quantum calculations, hence why this study was conducted using MM methods to simulate our DNA based systems. Some of the limitations of MM methods, including lower accuracy and the lack of the ability of bond rearrangement was considered, and determined to be a non issue for the systems at hand. Furthermore, QM simulations are too expensive to run for adequate amount of time (nanoseconds of simulations) that is required to reach and sample the equilibrium state. The size of the system is also an important decision factor in choosing between QM and MM. Roughly speaking, QM simulations have on the order of a couple of hundreds of atoms, while MM simulations are routinely run with tens of thousands of atoms.

\section{Theoretical details of molecular simulations}

Simulating molecular systems is, at a high level, very simple and straight forward. First, build a particle based description of you systems, where particles are the only entities that can interact with each other or the environment. Then, based on rules, propagate the system through time starting from some initial state (as described before the state of a system is the position and velocities of every particle) for a given number of steps or iterations. The rules by which you propagate the system can be either deterministic or random. As you build up a collection of consecutive states of the simulated system, certain properties can be calculated per frame (frame being a state in the context of a simulation) or averaged over multiple states to get ensemble estimates over time. 

There are two main categories of molecule simulations based on the nature of the propagation rules: Molecular Dynamics (MD) or Monte Carlo (MC). Molecular dynamics refers to the numerical integration of the equations of motion. They are used to investigate thermodynamic properties as well as structural and dynamical phenomena of the system. Monte Carlo type simulations on the other hand, generate new states based on the current state via probabilistic rules. The set of states generated this way can be used to predict thermodynamic and structural properties, but \emph{not} dynamical ones. This is because a MC simulation has no concept of time by which states are ordered and evolved.

\subsection{Equation of motion}

\subsection{Forcefield}

The molecular mechanics model described in section~\ref{sec:mm} is based on a number of interatomic potential energy functions. All these potential energy functions have a number of constants, the values of which are fitted to higher level calculations or experiment.

In order to have credibility in the theoretical models that are used to predict experimental measurements, or more drastically, substituting them, we have to validate the force fields that are used in the molecular dynamics simulations. In particular, the last generation of force-fields for DNA systems specifically has raised questions about their validity especially at longer simulation timescales. It was found that while not all theoretical simulations are equally reliable, the latest generation of force fields of the AMBER family designed to model DNA (BSC1 and OL15) can be safely used to reproduce the global structure of DNA, and predict observable quantities of interest, like the free energy of binding. They provide the most accurate results when comparing MD trajectory simulation data to experimental observables like NMR structure of X-Ray resolved structures. Furthermore, these forcefields reproduce experiments in an unbiased environment, and a common technique to force DNA trajectory to align with experimental data, termed restrained MD, is not essential for this study.

\input{md_steps}

\input{integrators_thermostats_barostats}

\section{Free energy calculations}

\subsection{Kinetic interpretation}

Planar aromatic molecules containing a fused ring system scaffold can intercalate between consecutive DNA base pairs. They are termed intercalators. Whilst there are cases when intercalators form covalent bonds with the DNA base pairs this is an irreversible process. If the bonding is facilitated via non-bonded interactions only ($\pi$ stacking), then the interaction is reversible. The study here is only concerned with the later intercalation type, as this is the more common form and the tools used (molecular mechanics) are suited to model this type of interaction only. In a solution containing double stranded DNA fragments and the intercalator, they will be constantly interacting, with the intercalator binding and unbinding from the DNA. This process can be modelled by a reversible chemical reaction

\begin{equation}
  A + B \rightarrow AB
\end{equation}

where the rate constant of the forward and backward reaction are the intercalation and de-intercalation reaction rates respectively. In equilibrium the two rate equal, therefore the concentration of each component (DNA, intercalator, and complex) is constant. The association constant $K_a$ is determined by the concentrations at equilibrium, and is given by
\begin{equation}
  K_a = \frac{k_1}{k_{-1}} = \frac{[AB]_{eq}}{[A]_{eq} [B]_{eq}}
\end{equation}

\subsection{Thermodynamic interpretation: the binding affinity}

One can interpret the process of intercalation as the reaction to minimise the appropriate thermodynamic potential for the given ensemble. The most common ensemble for the experimental conditions is the NPT ensemble, because the number of molecules, pressure and temperature are constant. The associated potential if the Gibbs free energy, $G$, given by

\begin{equation}
  G = U + pV - TS = H - TS
\end{equation}

The intercalation will happen spontaneously if the difference in free energy ($\Delta G$) between the intercalator and DNA in free state and the complex is negative. The intercalation then will happen until the free energy is minimised and equilibrium has been reached. This difference can be calculated as

\begin{equation}
  \Delta G = G(complex) - G(DNA) - G(intercalator)
\end{equation} 

the numerical value corresponding to the strength of binding, with more negative values being stronger binders. The change in free energy can also be related to the aforementioned equilibrium constant $K_a$ via the van't Hoff equation

\begin{equation}
  \Delta G = - R T \log K_a
\end{equation}

This means that the temperature and the free energy difference are closely related. If the temperature increases then the concentration of the complex also increases at the equilibrium. The value of $\Delta G$ is often called binding affinity or free energy of binding. The two terms can be used interchangeably. For certain use cases it is meaningful to break down the free energy difference into an enthalpic and entropic component

\begin{equation}
  \Delta G = \Delta H - T \Delta S
\end{equation} 

\section{Computational methods for free energy calculations}

An approach to calculating the binding free energy is via computational techniques. This method form the basis of this thesis. To compute the free energy this way offers a number of advantages over investigating the system experimentally. Molecules that cannot be synthesis can be simulated in silico, and we can study systems at an atomistic level. Molecular simulations provide this level of detail, but in order to calculate the macroscopic properties (like the free energy) we have to use statistical methods to derive them from the the microscopic simulations.

\subsection{Theoretically exact free energy methods}

There are a number of formally exact methods to calculate the free energy from simulation. By exact we mean that it contains to empirically fitted parameters in the equations. Two of the main techniques are called free energy perturbation (FEP) which is based on exponential averages of the change in the potential energy, and thermodynamic integration (TI) which is based on integrating the system as it changes from one state to another through an alchemical pathway. Due to considerations in computational efficiecy, the theoretically exact calculations compute free energy \emph{differences} simulated via non-physical system transformations (known as alchemical transformations). A thermodynamic cycle can illustrate how these alchemical changes can be related to relative differences which are of real interest

\subsubsection{The thermodynamic cycle}

Free energy is a function of state and as such cumulative variations around a closed thermodynamic cycle sum to zero. Figure 3.2 depicts such a cycle which could be used to calculate the relative binding affinity, ∆∆Gbind, of two different ligands to the same target where

\begin{figure}
  \centering
  \input{afe_diagramm}
  \caption{Thermodynamic cycle}
  \label{fig:tiescycle}
\end{figure}

\subsection{Approximate methods}

\subsection{Sources of error}

Modelling the system and running simulations, just like experimental techniques, contain sources of error. There are two major sources or inaccuracy in MD simulations: phase space sampling, and force field inaccuracy.

\subsubsection{Incomplete phase space sampling}

It is key to sample the phase space adequately and obtain results that are well converged, as this is a requirement for reliable free energy values. The complete phase space of DNA is large, and it is not possible to sample all of this with simulation methods, therefore we have to make sure that the phase space that we do sample is representative. To understand what we mean by representative sampling, consider that the phase space of a DNA is a set of energy minima separated by energy barriers of different size. Being and sampling only one minima is clear to not be enough to get reliable results. On the other hand if we sample a large number of these minimise the changes are that a representative portion of the landscape has been explored. In general the complete topology of the landscape is not known, and neither is the extent to which our simulation sampled it, therefore comparing the observable results to experiment is an important metric to consider.

\subsubsection{Force field accuracy}

Even if we were to completely sample the free energy landscape, the accuracy of our results will be limited by how well the model describes the physical system. Because for the systems under investigation in this thesis, quantum mechanical approaches are impractical due to the size of the system, the accuracy of the model will largely depend on how well the force field describes the interactions of the particles.

\input{methods}

\input{results}

\input{conclusion}

\end{document}